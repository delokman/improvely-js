<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!-- for mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> -->

    <title> 游戏看板 - gamekanban.com </title>

    <script type="text/javascript" src="./assets/js/prerequisite.min.js"></script>
    <script type="text/javascript" src="./use-assets.js">
        pageConfig.PAGEID = 'dashboard.html';
        pageConfig.pageURI = new Utils.URI(window.location.href);
        pageConfig.assetsRoot = './assets/';
    </script>

    <script type="text/javascript">
        pageConfig = window.appConfig['dashboard.html'];
        var userprefs = pageConfig.userPrefs;
        Utils.log(userprefs);

        var currency_symbol = userprefs.currency_symbol;
    </script>
</head>
<body>
    <div class="navbar navbar-default navbar-static-top" style="margin-bottom: 0">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-nav-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar" style="background: #fff"></span>
                    <span class="icon-bar" style="background: #fff"></span>
                    <span class="icon-bar" style="background: #fff"></span>
                </button>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="top-nav-collapse">
                <ul class="nav navbar-nav"> 
                    <li class="dropdown project">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-folder-open"></i>
                            <span style="font-weight: normal">当前:</span>
                            <span id="current_game"><!--游戏名--></span>
                            <span class="caret"></span>
                        </a>

                        <ul class="dropdown-menu">
                            <li class="heading">
                                <div class="pull-right">
                                    <a href="javascript:;" onclick="gotoPage('./main.html'); return false;">
                                        游戏列表
                                    </a>
                                </div>
                                切换游戏
                            </li>
  
                            <!-- gameid-template -->
                            <div id="gameid-template" style="display:none">
                                <li id="gameid-{{gameid}}" class="project" style="padding:0">
                                    <a href="javascript:;" style="display:block; float:right; text-align:right; color:#08c; padding:10px 15px 10px 5px"
                                        onclick="gotoPage('./settings.html', {
                                            gameid: '{{gameid}}',
                                            gamename: '{{gamename}}'
                                        }); return false;">
                                        <i class="fa fa-cog"></i>
                                        设置
                                    </a>
                                    <a href="javascript:;" style="clear:none; display:block; padding:10px 5px 10px 15px; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; width:190px; padding-right:0"
                                        onclick="gotoPage('./dashboard.html', {
                                            gameid: '{{gameid}}',
                                            gamename: '{{gamename}}'
                                        }); return false;">
                                        <i class="fa fa-folder"></i>
                                        {{gamename}}
                                    </a>
                                </li>
                            </div><!--// gameid-template -->

                            <li class="footer">
                                <form method="get" action="./new.html">
                                    <input type="submit" value="创建新游戏" class="btn btn-success btn-sm" />
                                </form>
                            </li>
                        </ul>
                    </li>
                </ul>

                <ul class="nav navbar-nav navbar-right"> 
                    <li class="dropdown alerts" id="alerts">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-bell"></i> 
                            <span class="label label-info">3</span>
                        </a>

                        <ul class="dropdown-menu">
                            <li class="dropdown-header">最新消息</li>

                            <li id="news_15" class="news">
                                <a href="javascript:void();">
                                <i class="fa fa-circle" style="color: #5bc0de"></i>&nbsp;
                                    2016-10-11: 游戏活跃人数过千万
                                </a>
                            </li>

                            <li id="news_14" class="news">
                                <a href="https://www.improvely.com/blog/2016/06/24/new-metric-converted-people/">
                                <i class="fa fa-circle" style="color: #5bc0de"></i>&nbsp; 
                                    2015-09-22: 游戏活跃人数过百万
                                </a>
                            </li>

                            <li id="news_14" class="news">
                                <a href="https://www.improvely.com/blog/2016/06/24/new-metric-converted-people/">
                                <i class="fa fa-circle" style="color: #5bc0de"></i>&nbsp; 
                                    2013-08-10: 游戏活跃人数过万
                                </a>
                            </li>
                        </ul>
                    </li>

                    <li class="dropdown profile">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-cog fa-lg"></i>
                            帐号设置
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="/plan"><i class="fa fa-credit-card"></i> Plan &amp; Billing Info</a></li>
                            <li><a href="/users"><i class="fa fa-users"></i> 管理用户 </a></li>
                            <li><a href="/api"><i class="fa fa-key"></i> API 证书</a></li>
                        </ul>
                    </li>

                    <li class="dropdown profile">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <img src="https://www.gravatar.com/avatar/cbea0da6158fb08afead8143a5d461a2?s=24&d=identicon" 
                                style="border: 1px solid #ccc; border-radius: 2px; position: absolute; top: 12px; left: 15px" />
                            <span style="margin-left: 33px">signinuser@shinezone.com</span>
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="./myprofile.html"><i class="fa fa-user"></i> 我的帐号 </a></li>
                            <li><a href="./referral.html"><i class="fa fa-user-plus"></i> 推荐给朋友 </a></li>
                            <li><a href="./signout.html"><i class="fa fa-power-off"></i> 退出登录 </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <script type="text/javascript">
                initOwnerGames("./api/");
            </script>
        </div> <!-- /container -->
    </div> <!-- /navbar -->

    <!-- main meuns -->
    <div class="navbar navbar-subnav">
        <div class="container">
            <ul class="nav navbar-nav navbar-sub"> 
                <li><a href="javascript:;" onclick="gotoPage('./dashboard.html'); return false;"><i class="fa fa-th-large"></i> 游戏看板 </a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-bar-chart"></i><span> 游戏外部舆情 </span><b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="javascript:;" onclick="gotoPage('./external/feedback-stat.html'); return false;"><i class="fa fa-globe"></i> 游戏反馈统计 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./external/forum-stat.html'); return false;"><i class="fa fa-bullhorn"></i> 论坛发帖统计 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./external/publish-stat.html'); return false;"><i class="fa fa-search"></i> 渠道统计分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./external/loss-factor.html'); return false;"><i class="fa fa-filter"></i> 流失因素分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./external/user-chatting.html'); return false;"><i class="fa fa-share-alt"></i> 玩家聊天分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./external/user-portrait.html'); return false;"><i class="fa fa-share"></i> 玩家画像追踪 </a></li>                    
                        <li><a href="javascript:;" onclick="gotoPage('./external/game-graph.html'); return false;"><i class="fa fa-link"></i> 相关游戏图谱 </a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-exclamation-triangle"></i><span> 游戏内数据服务 </span> <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="javascript:;" onclick="gotoPage('./internal/potential-loss.html'); return false;"><i class="fa fa-line-chart"></i> 潜在流失用户分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/potential-paid.html'); return false;"><i class="fa fa-line-chart"></i> 潜在付费用户分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/user-clustering.html'); return false;"><i class="fa fa-line-chart"></i> 用户聚类分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/individual-referral.html'); return false;"><i class="fa fa-line-chart"></i> 个性化推荐系统 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/action-predicting.html'); return false;"><i class="fa fa-line-chart"></i> 用户行为预测服务 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/user-fondness.html'); return false;"><i class="fa fa-line-chart"></i> 用户喜好度分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/game-chatting.html'); return false;"><i class="fa fa-line-chart"></i> 游戏内聊天分析 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/health-trends.html'); return false;"><i class="fa fa-line-chart"></i> 游戏健康趋势评估 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/logging-search.html'); return false;"><i class="fa fa-line-chart"></i> 日志监控与搜索服务 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/value-evaluation.html'); return false;"><i class="fa fa-line-chart"></i> 游戏数值评估系统 </a></li>
                        <li><a href="javascript:;" onclick="gotoPage('./internal/anti-fraud.html'); return false;"><i class="fa fa-line-chart"></i> 反欺诈分析 </a></li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-wrench"></i> <span> 管理工具 </span> <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/tools/webshop/import"><i class="fa fa-upload"></i> Import PPC Costs</a></li>
                        <li><a href="/tools/webshop/affiliate/import"><i class="fa fa-money"></i> Import Affiliate Commissions</a></li>
                        <li><a href="/tools/webshop/links"><i class="fa fa-link"></i> Manage Tracking Links</a></li>
                        <li><a href="/reports/webshop/people/explore"><i class="fa fa-users"></i> People Explorer</a></li>
                        <li><a href="/reports/webshop/realtime"><i class="fa fa-eye"></i> Realtime Spy</a></li>
                    </ul>
                </li>
            </ul>

            <ul class="nav navbar-nav navbar-right" style="margin-right: 0">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle btn-success btn btn-sm" data-toggle="dropdown" style="font-weight: bold; margin: 9px 0; padding: 4px 10px; background: #5eb95e">
                        <i class="fa fa-plus"></i> 新建 <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" style="margin-top: -9px">
                        <li><a href="/tools/webshop/link_builder"><i class="fa fa-link"></i> Tracking Link</a></li>
                        <li><a href="/tools/webshop/link_builder?ab=true"><i class="fa fa-random"></i> A/B Split Test</a></li>
                        <li><a href="/tools/webshop/affiliate/link_builder"><i class="fa fa-share"></i> Affiliate Outlink</a></li>
                        <li><a href="/tools/webshop/funnel_builder"><i class="fa fa-filter"></i> Funnel Report</a></li>
                        <li><a href="/user"><i class="fa fa-user"></i> User</a></li>
                    </ul>
                </li>
            </ul>
        </div> <!-- /container -->    
    </div> <!-- /navbar -->

    <!-- page specific -->
    <div class="container">
        <script type="text/javascript">
            currency_symbol = '$';
        </script>

        <div class="row">
            <div class="col-md-12">
                <div id="daterange" class="selectbox pull-right">
                    <i class="fa fa-calendar"></i>
                    <span>2016-09-20 - 2016-10-19</span> <b class="caret"></b>
                </div>

                <!--
                <div class="pull-right" style="margin-right: 10px">
                    <select name="goal" id="goalfilter" style="width:150px" multiple="multiple">
                        <option value="sale">Sale</option>
                    </select>
                </div>
                -->

                <div class="transparent-header">
                    <h2> 游戏A </h2>
                    <h1> 游戏看板 </h1>
                </div>
            </div>
        </div>

        <!-- main content -->
        <div class="row-narrow">
            <div class="col-md-12">
                <div style="position: relative; bottom: -1px; overflow: auto; padding: 0 5px">

                    <div id="feed_box" class="ovtab active" style="border-top-color: #333">
                        <h3><i class="fa fa-globe"></i>&nbsp; 游戏反馈 </h3>
                        <table>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Visits</td>
                            </tr>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Conversions</td>
                            </tr>
                        </table>
                    </div>

                    <div id="forum_box" class="ovtab" style="border-top-color: #d9534f">
                        <h3><i class="fa fa-bullhorn"></i>&nbsp; 论坛发帖 </h3>
                        <table>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Visits</td>
                            </tr>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Conversions</td>
                            </tr>
                        </table>
                    </div>

                    <div id="channel_box" class="ovtab" style="border-top-color: #2896dd">
                        <h3><i class="fa fa-share-alt"></i>&nbsp; 渠道统计 </h3>
                        <table>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Visits</td>
                            </tr>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Conversions</td>
                            </tr>
                        </table>
                    </div>

                    <div id="chatting_box" class="ovtab" style="border-top-color: #5eb95e">
                        <h3><i class="fa fa-search"></i>&nbsp; 玩家分析 </h3>
                        <table>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Visits</td>
                            </tr>
                            <tr>
                                <td class="num"><i class="fa fa-spinner fa-spin"></i></td>
                                <td class="desc">Conversions</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="page page-white" style="clear: both; border-top: 1px solid #ccc">
                    <div id="graph" style="padding: 10px 10px 0 10px">
                        <div class="pull-right">
                            <select name="graph_metric1" style="width: 140px">
                                <option value="people">People</option>
                                <option value="clicks">Visits</option>
                                <option value="converted_people">Conv. People</option>
                                <option value="conversions">Conversions</option>
                                <option value="convrate">Conversion Rate</option>
                                <option value="cost">Cost</option>
                                <option value="cpa">CPA</option>
                                <option value="cpc">CPC</option>
                                <option value="revenue">Revenue</option>
                                <option value="rpp">RPP</option>
                                <option value="profit">Profit</option>
                            </select>

                            <select name="graph_metric2" style="width: 140px">
                                <option value="people">People</option>
                                <option value="clicks">Visits</option>
                                <option value="converted_people">Conv. People</option>
                                <option value="conversions">Conversions</option>
                                <option value="convrate">Conversion Rate</option>
                                <option value="cost">Cost</option>
                                <option value="cpa">CPA</option>
                                <option value="cpc">CPC</option>
                                <option value="revenue">Revenue</option>
                                <option value="rpp">RPP</option>
                                <option value="profit">Profit</option>
                            </select>

                            <!--
                            <select name="graph_units" style="width: 100px; display: none">
                                <option value="days">Days</option>
                                <option value="weeks">Weeks</option>
                                <option value="months">Months</option>
                            </select>
                            -->

                            <btn class="btn btn-default btn-sm graph_download" rel="tooltip" title="Download Excel CSV" style="margin-left: 7px; background: #fff; border-width: 1px"><i class="fa fa-download"></i></btn>

                        </div>

                        <div id="reports-template" style="display:block">
                            <a id="forum_report" class="pull-left btn btn-default btn-sm btn-report" style="display: none" href="javascript:;"
                                onclick="gotoPage('./external/forum-stat.html'); return false;">
                                <i class="fa fa-bar-chart"></i>&nbsp;论坛发帖统计报告
                            </a>
                            <a id="channel_report" class="pull-left btn btn-default btn-sm btn-report" style="display: none" href="javascript:;"
                                onclick="gotoPage('./external/publish-stat.html'); return false;">
                                <i class="fa fa-bar-chart"></i>&nbsp;渠道相关统计分析
                            </a>
                            <a id="chatting_report" class="pull-left btn btn-default btn-sm btn-report" style="display: none" href="javascript:;"
                                onclick="gotoPage('./external/user-chatting.html'); return false;">
                                <i class="fa fa-bar-chart"></i>&nbsp;玩家聊天分析报告
                            </a>
                            <a id="feed_report" class="pull-left btn btn-default btn-sm btn-report" href="javascript:;"
                                onclick="gotoPage('./external/feedback-stat.html'); return false;">
                                <i class="fa fa-bar-chart"></i>&nbsp;游戏反馈统计报告
                            </a>
                        </div>

                        <div class="placeholder" style="clear: both; height: 200px; margin: 0 -10px"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row-narrow">
            <div class="metrics">
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="people"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="clicks"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="converted_people"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="conversions"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="convrate"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="cost"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="costpergoal"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="costperclick"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="revenue"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="goalvalue"></div></div>	
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="revperson"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="profit"></div></div>
                <div class="col-xs-6 col-md-4 col-sm-3"><div class="roi"></div></div>
            </div>
        </div>

        <script type="text/javascript">

            type = 'all';

            $(document).ready(function() {

                $('.ovtab a').click(function(e) {
                    e.stopPropagation();
                })

                $('.ovtab').click(function() {

                    type = $(this).attr('id').replace('_box', '');
                    
                    $('.metrics div div').css('border-top-color', $(this).css('border-top-color'));
                    $('.ovtab').removeClass('active');
                    $(this).addClass('active');

                    $('.btn-report').hide();
                    $('#' + type + '_report').show();
                    
                    ///getMetrics();

                });

                ///getMetrics();
                ///getTabs();
            });


            function getTabs(start, end) {
                // Get Tab Metrics
                var jsonurl = '/api/metrics.json?graph=1&filters[goal]=' + encodeURIComponent(userprefs.goal);
                jsonurl += '&type=' + type;
                if (typeof start != 'undefined' && typeof end != 'undefined')
                    jsonurl += '&start=' + encodeURIComponent(start) + '&end=' + encodeURIComponent(end);

                $('.ovtab .num').html('<i class="fa fa-spinner fa-spin"></i>');
                $.getJSON(jsonurl, function(data) {
                    $('.ovtab .num').html('0');
                    var tv = 0, tc = 0;
                    for (var i = 0; i < data.length; i++) {
                        var row = data[i];
                        $('#' + row['type'] + '_box .num:first').html(add_commas(row['visits']));
                        $('#' + row['type'] + '_box .num:last').html(add_commas(row['conversions']));
                        tv += parseInt(row['visits']);
                        tc += parseInt(row['conversions']);
                    }
                    $('#feed_box .num:first').html(add_commas(tv));
                    $('#feed_box .num:last').html(add_commas(tc));
                });
            }


            function getMetrics(start, end) {

                $('#graph .placeholder').html('<div style="padding: 80px 0 0 0; text-align: center; font-size: 33px"><i class="fa fa-spinner fa fa-spin"></i></div>');
                $('#graph h1, #graph h2').html('&nbsp;');
                $('#graph .metric1 h1').html('<i class="fa fa-spinner fa-spin"></i>');

                $('.metrics div div').html('<div class="graph"></div><div class="over"><h4></h4><span><i class="fa fa-spinner fa fa-spin" style="margin-top: 20px"></i></span></div>');

                if (type == 'all' || type == 'ad') {
                    $('.metrics .cost, .metrics .profit, .metrics .costpergoal, .metrics .costperclick, .metrics .roi').each(function() {
                        $(this).parent().show();
                    });
                } else {
                    $('.metrics .cost, .metrics .profit, .metrics .costpergoal, .metrics .costperclick, .metrics .roi').each(function() {
                        $(this).parent().hide();
                    });
                }

                var jsonurl = '/api/graph.json?graph=1&filters[goal]=' + encodeURIComponent(userprefs.goal);
                if (type != 'all')
                    jsonurl += '&filters[' + type + ']=1';
                jsonurl += '&metric1=' + userprefs.metric1 + '&metric2=' + userprefs.metric2 + '&units=' + userprefs.units;
                if (typeof start != 'undefined' && typeof end != 'undefined')
                    jsonurl += '&start=' + encodeURIComponent(start) + '&end=' + encodeURIComponent(end);

                $.getJSON(jsonurl, function(data) {

                    imGraph('graph', data);

                    var last7 = [];
                    for (var i = 0; i < data.length - 1; i++) {
                        last7.push(data[i]);
                    }

                    var data = data[data.length - 1];

                    // People
                    metricGraph($('.metrics .people .graph')[0], last7, 'people');

                            var url = '/reports/webshop/people';
                    if (type != 'all')
                        url += '?filters[' + type + ']=1';

                    $('.metrics .people span').html('<a href="' + url + '">' + add_commas(data.people) + '</a>');
                    $('.metrics .people h4').html('People');

                    // Clicks
                    metricGraph($('.metrics .clicks .graph')[0], last7, 'clicks');

                            var url = '/reports/webshop/clicks';
                    if (type != 'all')
                        url += '?filters[' + type + ']=1';

                    $('.metrics .clicks span').html('<a href="' + url + '">' + add_commas(data.clicks) + '</a>');
                    $('.metrics .clicks h4').html((type == 'ad') ? 'Visits (Ad Clicks)' : 'Visits');

                    // Conversions
                    metricGraph($('.metrics .conversions .graph')[0], last7, 'conversions');

                            var url = '/reports/webshop/conversions?filters[goal]=' + encodeURIComponent(userprefs.goal);
                    if (type != 'all')
                        url += '&filters[' + type + ']=1';

                    $('.metrics .conversions span').html('<a href="' + url + '">' + add_commas(data.conversions) + '</a>');
                    $('.metrics .conversions h4').html('Goal Conversions');

                    // Converted people
                    metricGraph($('.metrics .converted_people .graph')[0], last7, 'converted_people');

                            var url = '/reports/webshop/conversions?filters[goal]=' + encodeURIComponent(userprefs.goal);
                    if (type != 'all')
                        url += '&filters[' + type + ']=1';

                    $('.metrics .converted_people span').html('<a href="' + url + '">' + add_commas(data.converted_people) + '</a>');
                    $('.metrics .converted_people h4').html('Converted People');

                    // Conversion Rate
                    metricGraph($('.metrics .convrate .graph')[0], last7, 'convrate');
                    $('.metrics .convrate span').html(format_rate(data.converted_people / data.people));
                    $('.metrics .convrate h4').html('Conversion Rate');

                    // Revenue
                    metricGraph($('.metrics .revenue .graph')[0], last7, 'revenue');
                    $('.metrics .revenue span').html(format_money(data.revenue, true));
                    $('.metrics .revenue h4').html('Revenue');		

                    // Average Goal Value
                    metricGraph($('.metrics .goalvalue .graph')[0], last7, 'goalvalue');
                    $('.metrics .goalvalue span').html(format_money(data.revenue / data.conversions));
                    $('.metrics .goalvalue h4').html('Average Goal Value');		

                    // Revenue Per Person
                    metricGraph($('.metrics .revperson .graph')[0], last7, 'rpp');
                    $('.metrics .revperson span').html(format_money(data.revenue / data.people));
                    $('.metrics .revperson h4').html('Revenue Per Person');

                    if (type == 'all' || type == 'ad') {

                        // Cost
                        metricGraph($('.metrics .cost .graph')[0], last7, 'cost');
                        $('.metrics .cost span').html(format_money(data.cost, true));
                        $('.metrics .cost h4').html('Cost');

                        // Profit
                        metricGraph($('.metrics .profit .graph')[0], last7, 'profit');
                        $('.metrics .profit span').html(format_money(data.revenue - data.cost, true));
                        $('.metrics .profit h4').html('Profit');

                        // Cost Per Goal
                        metricGraph($('.metrics .costpergoal .graph')[0], last7, 'cpa');
                        $('.metrics .costpergoal span').html(format_money(data.cost / data.conversions));
                        $('.metrics .costpergoal h4').html('Cost Per Acquisition');

                        // Cost Per Click
                        metricGraph($('.metrics .costperclick .graph')[0], last7, 'cpc');
                        $('.metrics .costperclick span').html(format_money(data.cost / data.clicks));
                        $('.metrics .costperclick h4').html('Cost Per Click');

                        // Return On Investment
                        metricGraph($('.metrics .roi .graph')[0], last7, 'roi');
                        var roi = (data.revenue - data.cost) / data.cost;
                        $('.metrics .roi span').html(format_rate(roi));
                        $('.metrics .roi h4').html('Return On Investment');
                    }

                });

            }


            function downloadGraph() {
                var dlurl = '/api/graph.xls';
                dlurl += '?filters[goal]=' + encodeURIComponent(userprefs.goal);
                dlurl += '&metric1=' + userprefs.metric1 + '&metric2=' + userprefs.metric2;
                if (type != 'all')
                    dlurl += '&filters[' + type + ']=1';

                if (typeof location.search == 'string' && location.search.length > 0)
                    dlurl += '&' + location.search.substring(1);
                window.location = dlurl;
            }
        </script>

        <div class="row">
            <div class="col-md-12">
                <!-- feedback -->
                <div id="feedback">
                    <form action="" class="form-horizontal" method="post">
                        <div class="row">
                            <div class="col-md-10" style="padding-right: 5px">
                                <textarea name="feedback" class="form-control"></textarea>
                            </div>
                            <div class="col-md-2" style="text-align: center">
                                <input type="submit" name="submit" value="反馈给我们" class="btn btn-success" style="width: 100%" />
                            </div>
                        </div>
                    </form>
                </div>

                <!-- copyright -->
                <div id="footer">
                    <div class="pull-right" style="text-align: right; padding-top: 5px">Copyright &copy; 2016
                        <a href="http://www.shinezone.com/">炫踪网络信息科技有限公司</a>
                        <br />
                        <a href="./terms.html">服务条款</a>&nbsp;&middot;&nbsp;
                        <a href="./docs.html">使用说明</a> &nbsp;&middot;&nbsp;
                        <a href="mailto:zhangliang@shinezone.com">联系我们</a>
                    </div>
                    <a href="http://www.shinezone.com/">
                        <img alt="Shinezone Logo" src="./assets/images/logo.png" />
                    </a>
                </div>      
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="afs_ads" style="color: #ccc; font-size: 10px; text-align: right; padding: 5px 0">version:20161012</div>
            </div>
        </div>
    </div>
</body>
</html>

